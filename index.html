<!-- Carregue o Firebase SDK com módulos -->
<script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js';
    import { getDatabase, ref, push, onValue } from 'https://www.gstatic.com/firebasejs/9.6.10/firebase-database.js';

    // Configuração do Firebase
    const firebaseConfig = {
        databaseURL: "https://chapa2025-default-rtdb.firebaseio.com/"
    };

    // Inicializa o Firebase
    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);

    // Função para registrar voto no Firebase
    function registrarVoto() {
        const grupo = document.getElementById("grupo").value;
        if (!grupo) {
            alert("Escolha um grupo para votar!");
            return;
        }

        // Salva o voto no banco de dados Firebase
        push(ref(database, 'votos'), {
            grupo: grupo
        }).then(() => {
            alert("Voto registrado com sucesso!");
        }).catch(error => {
            alert("Erro ao registrar voto: " + error.message);
        });
    }

    // Função para visualizar os resultados dos votos em tempo real
    function visualizarResultados() {
        const resultadosRef = ref(database, 'votos');
        onValue(resultadosRef, (snapshot) => {
            const votos = snapshot.val();
            const contagem = {};

            if (votos) {
                Object.values(votos).forEach(voto => {
                    contagem[voto.grupo] = (contagem[voto.grupo] || 0) + 1;
                });
            }

            const lista = document.getElementById("resultados");
            lista.innerHTML = "";
            for (const [grupo, total] of Object.entries(contagem)) {
                const item = document.createElement("li");
                item.textContent = `${grupo}: ${total} votos`;
                lista.appendChild(item);
            }
        });
    }

    // Inicia a visualização dos resultados ao carregar a página
    visualizarResultados();
</script>
